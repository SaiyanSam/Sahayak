{% extends "base.html" %}

{% block content %}
<section class="fundraisers">
    <h2 class="section-title">Available Fundraisers</h2>

    <!-- Flash message container -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            <div id="flash-messages">
                {% for category, message in messages %}
                    <div class="alert alert-{{ category }}">{{ message }}</div>
                {% endfor %}
            </div>
        {% endif %}
    {% endwith %}

    <div class="fundraiser-grid">
        {% for fundraiser in fundraisers %}
        <div class="fundraiser-card">
            {% if fundraiser.image_filename %}
                <img src="{{ url_for('static', filename='uploads/' + fundraiser.image_filename) }}" alt="{{ fundraiser.title }}">
            {% else %}
                <img src="{{ url_for('static', filename='images/default.png') }}" alt="Default Image">
            {% endif %}
            <h3>{{ fundraiser.title }}</h3>
            <p>{{ fundraiser.description }}</p>
            <p><strong>Goal:</strong> ₹{{ fundraiser.goal }}</p>
            <p><strong>Raised:</strong> ₹{{ fundraiser.total_donated or 0.0 }}</p>
            <div class="progress-bar">
                <div class="progress" style="width: {{ fundraiser.total_donated / fundraiser.goal * 100 if fundraiser.goal else 0 }}%;"></div>
            </div>
            
            <form action="{{ url_for('donate', fundraiser_id=fundraiser.id) }}" method="POST">
                <label for="amount">Amount:</label>
                <input type="number" id="amount" name="amount" placeholder="Enter amount to donate" min="1" required>
                <button type="submit">Proceed to Pay</button>
            </form>
        </div>
        {% endfor %}
    </div>
</section>
{% endblock %}
